// Generated by CoffeeScript 1.3.3
(function() {

  $(function() {
    var App;
    App = Em.Application.create({
      rootElement: '#content'
    });
    App.Router = Em.Router.extend({
      enableLogging: true,
      location: 'hash',
      root: Em.Route.extend({
        goToUser: Em.route.transitionTo('user-details'),
        goToUserRace: Em.route.transitionTo('user-race'),
        index: Em.Route.extend({
          route: '/',
          redirectsTo: 'user-details'
        }),
        userDetails: Em.Route.extend({
          route: '/user/:id',
          connectOutlets: function(router, context) {
            return route.get('applicationController').connectOutlet(App.UserDetailView, App.userController.loadUser);
          },
          enter: function() {
            return Em.run.next(function() {});
          },
          exit: function() {}
        })
      })
    });
    App.User = Em.Object.extend({
      id: '',
      first_name: '',
      last_name: '',
      charities: [],
      races: [],
      img: null,
      disp_name: function() {
        return "" + (this.get('first_name')) + " " + (this.get('last_name'));
      }
    });
    App.Race = Em.Object.extend({
      id: '',
      name: '',
      location: '',
      lat: 0,
      lng: 0,
      distance: 0,
      units: '',
      datetime: '',
      url: null,
      img: null,
      blurb: ''
    });
    App.Charity = Em.Object.extend({
      id: '',
      name: '',
      img: null,
      url: null,
      blurb: ''
    });
    App.Challenge = Em.Mixin.create({
      from: null,
      to: null,
      race: '',
      flat: 0,
      bonus: 0,
      scale: 1,
      unit: 0,
      charity: null,
      init: function() {
        this._super;
        this.set('from', App.User.create);
        return this.set('to', App.User.create);
      }
    });
    App.Participant = Em.Mixin.create({
      user: null,
      race: null,
      goal: 0,
      result: '',
      bib: '',
      charities: null,
      init: function() {
        this._super;
        this.set('user', App.User.create);
        this.set('race', App.Race.create);
        return this.set('charities', [App.Charity.create()]);
      }
    });
    App.UserDetailsView = Em.View.extend({
      templateName: '../views/user-details.ember'
    });
    App.UserRaceView = Em.View.extend({
      templateName: '../views/user-race.ember'
    });
    App.ApplicationController = Em.Controller.extend();
    App.userController = Em.ObjectController.extend({
      id: '',
      user: null,
      loadUser: function() {
        var id, me, url;
        me = this;
        id = me.get('id');
        if (id) {
          url = "/static/js/pymwyfa_stub.json?v=" + id;
          return $.getJSON(url, function(data) {
            var theId, u, userData;
            me.set('user', null);
            userData = data.user_pages[id].info;
            theId = userData.id;
            u = App.User.create(userData);
            me.set('id', theId);
            return me.set('user', u);
          });
        }
      }
    });
    window.App = App;
    return App.initialize();
  });

}).call(this);
